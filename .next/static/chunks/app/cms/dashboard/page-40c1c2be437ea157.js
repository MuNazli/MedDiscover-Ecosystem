(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[172],{3780:function(e,t,s){Promise.resolve().then(s.bind(s,8022))},8022:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return n}});var l=s(7437),a=s(2265),r=s(154),c=s(2036),d=s(6540);function n(){let{uiLocale:e,setUiLocale:t}=(0,c.s)("de"),[s,n]=(0,a.useState)(null),[i,o]=(0,a.useState)(null),[x,b]=(0,a.useState)(!0),[u,h]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=!0;return b(!0),h(!1),Promise.all([fetch("/api/cms/dashboard",{method:"GET"}),fetch("/api/cms/trustscore/summary",{method:"GET"})]).then(async t=>{let[s,l]=t;if(!s.ok||!l.ok)throw Error("Failed");let a=await s.json(),r=await l.json();e&&(n(a),o(r))}).catch(()=>{e&&h(!0)}).finally(()=>{e&&b(!1)}),()=>{e=!1}},[]);let m=t=>(0,r.t)(e,"leadAudit.".concat(t)),p=t=>{let s=new Date,l=new Date(t),a=s.getTime()-l.getTime(),c=Math.floor(a/6e4),d=Math.floor(a/36e5);return c<1?(0,r.t)(e,"dashboard.timeJustNow"):c<60?"".concat(c).concat((0,r.t)(e,"dashboard.timeMinutesAgo")):d<24?"".concat(d).concat((0,r.t)(e,"dashboard.timeHoursAgo")):"".concat(Math.floor(a/864e5)).concat((0,r.t)(e,"dashboard.timeDaysAgo"))},g=e=>"STATUS_CHANGED"===e?"S":"NOTE_ADDED"===e?"N":"?",j=()=>{if(!s)return null;let{last24h:e,last7d:t}=s.totals;if(0===t)return null;let l=t/7;return 0===l?null:(e-l)/l*100};return x?(0,l.jsxs)("main",{className:"min-h-screen bg-white",children:[(0,l.jsx)("div",{className:"border-b border-black/10",children:(0,l.jsxs)("div",{className:"mx-auto flex w-full max-w-[1200px] items-center justify-between px-6 py-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-black",children:(0,r.t)(e,"dashboard.title")}),(0,l.jsx)("p",{className:"text-[13px] text-black/60",children:(0,r.t)(e,"dashboard.subtitle")})]}),(0,l.jsx)(d.Z,{currentLocale:e,onLocaleChange:t})]})}),(0,l.jsx)("section",{className:"mx-auto w-full max-w-[1200px] px-6 py-8 text-[13px] text-black/60",children:(0,r.t)(e,"general.loading")})]}):u||!s?(0,l.jsxs)("main",{className:"min-h-screen bg-white",children:[(0,l.jsx)("div",{className:"border-b border-black/10",children:(0,l.jsxs)("div",{className:"mx-auto flex w-full max-w-[1200px] items-center justify-between px-6 py-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-black",children:(0,r.t)(e,"dashboard.title")}),(0,l.jsx)("p",{className:"text-[13px] text-black/60",children:(0,r.t)(e,"dashboard.subtitle")})]}),(0,l.jsx)(d.Z,{currentLocale:e,onLocaleChange:t})]})}),(0,l.jsx)("section",{className:"mx-auto w-full max-w-[1200px] px-6 py-8",children:(0,l.jsx)("div",{className:"rounded-xl border border-red-200 bg-red-50 p-4 text-[13px] text-red-800",children:(0,r.t)(e,"dashboard.error")})})]}):(0,l.jsxs)("main",{className:"min-h-screen bg-white",children:[(0,l.jsx)("div",{className:"border-b border-black/10",children:(0,l.jsxs)("div",{className:"mx-auto flex w-full max-w-[1200px] items-center justify-between px-6 py-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-black",children:(0,r.t)(e,"dashboard.title")}),(0,l.jsx)("p",{className:"text-[13px] text-black/60",children:(0,r.t)(e,"dashboard.subtitle")})]}),(0,l.jsx)(d.Z,{currentLocale:e,onLocaleChange:t})]})}),(0,l.jsxs)("section",{className:"mx-auto w-full max-w-[1200px] px-6 py-8",children:[(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsxs)("div",{className:"rounded-xl border border-black/10 bg-white p-4",children:[(0,l.jsx)("div",{className:"text-[12px] uppercase tracking-wide text-black/50",children:(0,r.t)(e,"dashboard.kpiTotal")}),(0,l.jsx)("div",{className:"mt-2 text-3xl font-bold text-black",children:s.totals.total})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-black/10 bg-white p-4",children:[(0,l.jsx)("div",{className:"text-[12px] uppercase tracking-wide text-black/50",children:(0,r.t)(e,"dashboard.kpiLast7d")}),(0,l.jsx)("div",{className:"mt-2 text-3xl font-bold text-black",children:s.totals.last7d})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-black/10 bg-white p-4",children:[(0,l.jsx)("div",{className:"text-[12px] uppercase tracking-wide text-black/50",children:(0,r.t)(e,"dashboard.kpiLast24h")}),(0,l.jsxs)("div",{className:"mt-2 flex items-end gap-2",children:[(0,l.jsx)("span",{className:"text-3xl font-bold text-black",children:s.totals.last24h}),(()=>{let e=j();if(null!==e){let t=e>0;return(0,l.jsxs)("span",{className:"text-[11px] font-semibold ".concat(t?"text-green-600":"text-red-600"),children:[t?"+":"-"," ",Math.abs(Math.round(e)),"%"]})}return null})()]})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-black/10 bg-white p-4",children:[(0,l.jsx)("div",{className:"text-[12px] uppercase tracking-wide text-black/50",children:(0,r.t)(e,"dashboard.kpiOpen")}),(0,l.jsx)("div",{className:"mt-2 text-3xl font-bold text-black",children:s.totals.open})]})]}),i&&(0,l.jsxs)("div",{className:"mt-4 grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsxs)("div",{className:"rounded-xl border border-green-200 bg-green-50 p-4",children:[(0,l.jsx)("div",{className:"text-[12px] uppercase tracking-wide text-green-700",children:(0,r.t)(e,"trustScore.avgScore")}),(0,l.jsx)("div",{className:"mt-2 text-3xl font-bold text-green-800",children:i.avgScore}),(0,l.jsx)("div",{className:"mt-2 h-1.5 w-full overflow-hidden rounded-full bg-black/10",children:(0,l.jsx)("div",{className:i.avgScore>=70?"h-full bg-green-600":i.avgScore>=50?"h-full bg-yellow-600":"h-full bg-red-600",style:{width:"".concat(Math.min(100,Math.max(0,i.avgScore||0)),"%")},"aria-label":"Score: ".concat(i.avgScore,"%")})})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-green-200 bg-green-50 p-4",children:[(0,l.jsx)("div",{className:"text-[12px] uppercase tracking-wide text-green-700",children:(0,r.t)(e,"trustScore.active")}),(0,l.jsx)("div",{className:"mt-2 text-3xl font-bold text-green-800",children:i.counts.active})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-yellow-200 bg-yellow-50 p-4",children:[(0,l.jsx)("div",{className:"text-[12px] uppercase tracking-wide text-yellow-700",children:(0,r.t)(e,"trustScore.riskyHidden")}),(0,l.jsx)("div",{className:"mt-2 text-3xl font-bold text-yellow-800",children:i.counts.riskyHidden})]}),(0,l.jsxs)("div",{className:"rounded-xl border border-red-200 bg-red-50 p-4",children:[(0,l.jsx)("div",{className:"text-[12px] uppercase tracking-wide text-red-700",children:(0,r.t)(e,"trustScore.blacklisted")}),(0,l.jsx)("div",{className:"mt-2 text-3xl font-bold text-red-800",children:i.counts.blacklisted})]})]}),(0,l.jsxs)("div",{className:"mt-6 grid gap-6 md:grid-cols-3",children:[(0,l.jsxs)("div",{className:"rounded-xl border border-black/10 bg-white p-4",children:[(0,l.jsx)("div",{className:"mb-4 text-[14px] font-semibold text-black",children:(0,r.t)(e,"dashboard.statusOverview")}),(0,l.jsx)("div",{className:"space-y-3",children:(()=>{let t=s.statusCounts.NEW+s.statusCounts.IN_REVIEW+s.statusCounts.OFFER_SENT+s.statusCounts.CLOSED;return[{key:"NEW",count:s.statusCounts.NEW,color:"bg-blue-500"},{key:"IN_REVIEW",count:s.statusCounts.IN_REVIEW,color:"bg-purple-500"},{key:"OFFER_SENT",count:s.statusCounts.OFFER_SENT,color:"bg-orange-500"},{key:"CLOSED",count:s.statusCounts.CLOSED,color:"bg-green-500"}].map(s=>{let a=t>0?Math.round(s.count/t*100):0;return(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"mb-1 flex items-center justify-between text-[12px]",children:[(0,l.jsx)("span",{className:"text-black/70",children:(0,r.t)(e,"leadStatus.".concat(s.key))}),(0,l.jsxs)("span",{className:"font-semibold text-black",children:[s.count," ",(0,l.jsxs)("span",{className:"text-black/50",children:["(",a,"%)"]})]})]}),(0,l.jsx)("div",{className:"h-2 w-full overflow-hidden rounded-full bg-black/5",children:(0,l.jsx)("div",{className:"h-full ".concat(s.color),style:{width:"".concat(a,"%")},"aria-label":"".concat(s.key,": ").concat(a,"%")})})]},s.key)})})()})]}),i&&(0,l.jsxs)("div",{className:"rounded-xl border border-black/10 bg-white p-4",children:[(0,l.jsx)("div",{className:"mb-4 text-[14px] font-semibold text-black",children:(0,r.t)(e,"dashboard.trustScoreDistribution")}),(()=>{let t=i.counts.active+i.counts.riskyHidden+i.counts.blacklisted,s=[{key:"ACTIVE",count:i.counts.active,color:"bg-green-500"},{key:"RISKY_HIDDEN",count:i.counts.riskyHidden,color:"bg-yellow-500"},{key:"BLACKLISTED",count:i.counts.blacklisted,color:"bg-red-500"}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"mb-3 flex h-8 w-full overflow-hidden rounded-lg",children:0===t?(0,l.jsx)("div",{className:"flex h-full w-full items-center justify-center bg-black/5 text-[11px] text-black/50",children:(0,r.t)(e,"dashboard.noData")}):s.map(e=>{let s=t>0?e.count/t*100:0;return 0===s?null:(0,l.jsx)("div",{className:"".concat(e.color," flex items-center justify-center text-[10px] font-semibold text-white"),style:{width:"".concat(s,"%")},"aria-label":"".concat(e.key,": ").concat(Math.round(s),"%"),children:s>10&&Math.round(s)+"%"},e.key)})}),(0,l.jsx)("div",{className:"space-y-2",children:s.map(s=>{let a=t>0?Math.round(s.count/t*100):0;return(0,l.jsxs)("div",{className:"flex items-center justify-between text-[12px]",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"h-2.5 w-2.5 rounded-full ".concat(s.color)}),(0,l.jsx)("span",{className:"text-black/70",children:(0,r.t)(e,"trustScore.status.".concat(s.key))})]}),(0,l.jsxs)("span",{className:"font-semibold text-black",children:[s.count," ",(0,l.jsxs)("span",{className:"text-black/50",children:["(",a,"%)"]})]})]},s.key)})})]})})()]}),(0,l.jsxs)("div",{className:"rounded-xl border border-black/10 bg-white p-4",children:[(0,l.jsx)("div",{className:"mb-4 text-[14px] font-semibold text-black",children:(0,r.t)(e,"dashboard.recentActivity")}),(0,l.jsxs)("div",{className:"space-y-2",children:[0===s.recentAudits.length&&(0,l.jsx)("div",{className:"rounded-lg border border-black/10 bg-black/5 p-3 text-center text-[12px] text-black/60",children:(0,r.t)(e,"dashboard.noActivity")}),s.recentAudits.slice(0,8).map(t=>(0,l.jsxs)("div",{className:"flex items-start gap-2 rounded-lg border border-black/10 px-3 py-2",children:[(0,l.jsx)("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center rounded-full bg-black/5 text-[14px]",children:g(t.action)}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("div",{className:"text-[12px] font-medium text-black",children:m(t.action)}),(0,l.jsxs)("div",{className:"text-[11px] text-black/50 truncate",children:[(0,r.t)(e,"dashboard.leadLabel"),": ",t.leadId.substring(0,8),"..."]})]}),(0,l.jsx)("div",{className:"flex-shrink-0 text-right text-[11px] text-black/50",children:p(t.createdAt)})]},t.id))]})]})]}),i&&i.topRisky.length>0&&(0,l.jsxs)("div",{className:"mt-6 rounded-xl border border-black/10 bg-white p-4",children:[(0,l.jsx)("div",{className:"mb-4 text-[14px] font-semibold text-black",children:(0,r.t)(e,"trustScore.topRisky")}),(0,l.jsx)("div",{className:"grid gap-2 md:grid-cols-2 lg:grid-cols-3",children:i.topRisky.map(t=>{let s="BLACKLISTED"===t.trustStatus?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200",a="BLACKLISTED"===t.trustStatus?"text-red-800":"text-yellow-800";return(0,l.jsxs)("div",{className:"flex items-center justify-between rounded-lg border px-3 py-2 ".concat(s),children:[(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsxs)("div",{className:"text-[12px] font-medium ".concat(a," truncate"),children:[(0,r.t)(e,"dashboard.leadLabel"),": ",t.leadId.substring(0,8),"..."]}),(0,l.jsx)("div",{className:"text-[11px] text-black/50",children:(0,r.t)(e,"trustScore.status.".concat(t.trustStatus))})]}),(0,l.jsx)("div",{className:"flex-shrink-0 text-[16px] font-bold ".concat(a),children:t.score})]},t.leadId)})})]})]})]})}},6540:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var l=s(7437),a=s(154);function r(e){let{currentLocale:t,onLocaleChange:s}=e;return(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,l.jsx)("span",{style:{fontSize:13,color:"#64748b",fontWeight:500},children:(0,a.t)(t,"general.panelLanguage")}),(0,l.jsx)("div",{style:{display:"flex",gap:4,background:"#f8fafc",padding:4,borderRadius:6,border:"1px solid #e5e7eb"},children:a.kU.map(e=>(0,l.jsx)("button",{onClick:()=>s(e),style:{padding:"6px 12px",border:"none",borderRadius:4,background:t===e?"linear-gradient(135deg, #2EC4B6, #0FA3B1)":"transparent",color:t===e?"#fff":"#64748b",cursor:"pointer",fontSize:13,fontWeight:t===e?600:500,transition:"all 0.2s ease"},children:e.toUpperCase()},e))})]})}}},function(e){e.O(0,[36,971,23,744],function(){return e(e.s=3780)}),_N_E=e.O()}]);