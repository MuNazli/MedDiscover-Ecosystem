(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[415],{2854:function(e,t,s){Promise.resolve().then(s.bind(s,5404))},5404:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return n}});var l=s(7437),a=s(2265),r=s(154),i=s(2036),c=s(6540);function n(){let{uiLocale:e,setUiLocale:t}=(0,i.s)("de"),[s,n]=(0,a.useState)([]),[d,o]=(0,a.useState)(!0),[x,u]=(0,a.useState)(!1),[b,p]=(0,a.useState)(null),[h,m]=(0,a.useState)(null),[v,f]=(0,a.useState)({});(0,a.useEffect)(()=>{let e=!0;return o(!0),u(!1),fetch("/api/cms/trustscore/rules",{method:"GET"}).then(async t=>{if(!t.ok)throw Error("Failed");let s=await t.json(),l=Array.isArray(s.rules)?s.rules:[];if(e){n(l.map(e=>({...e,saving:!1})));let e={};l.forEach(t=>{e[t.code]={delta:t.delta,isActive:t.isActive}}),f(e)}}).catch(()=>{e&&u(!0)}).finally(()=>{e&&o(!1)}),()=>{e=!1}},[]);let j=e=>{let t=v[e.code];return!!t&&(t.delta!==e.delta||t.isActive!==e.isActive)},g=(e,t)=>{if(!Number.isFinite(t))return;let s=Math.min(100,Math.max(-100,Math.trunc(t)));n(t=>t.map(t=>t.code===e?{...t,delta:s}:t))},k=e=>{n(t=>t.map(t=>t.code===e?{...t,isActive:!t.isActive}:t))},N=e=>{let t=v[e];t&&n(s=>s.map(s=>s.code===e?{...s,delta:t.delta,isActive:t.isActive}:s))},y=async e=>{let t=s.find(t=>t.code===e);if(t){n(t=>t.map(t=>t.code===e?{...t,saving:!0}:t));try{let s=await fetch("/api/cms/trustscore/rules/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({delta:t.delta,isActive:t.isActive})});if(!s.ok)throw Error("Failed");let l=(await s.json()).rule;n(t=>t.map(t=>t.code===e?{...t,...l,saving:!1}:t)),f(t=>({...t,[e]:{delta:l.delta,isActive:l.isActive}})),p(e),m(Date.now())}catch(t){n(t=>t.map(t=>t.code===e?{...t,saving:!1}:t)),u(!0)}}},w=(0,a.useMemo)(()=>b&&h?10>Math.floor((Date.now()-h)/1e3)?(0,r.t)(e,"trustRules.saved"):(0,r.t)(e,"trustRules.savedRecently"):null,[b,h,e]);return d?(0,l.jsxs)("main",{className:"min-h-screen bg-white",children:[(0,l.jsx)("div",{className:"border-b border-black/10",children:(0,l.jsxs)("div",{className:"mx-auto flex w-full max-w-[1200px] items-center justify-between px-6 py-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-black",children:(0,r.t)(e,"trustRules.title")}),(0,l.jsx)("p",{className:"text-[13px] text-black/60",children:(0,r.t)(e,"trustRules.subtitle")})]}),(0,l.jsx)(c.Z,{currentLocale:e,onLocaleChange:t})]})}),(0,l.jsx)("section",{className:"mx-auto w-full max-w-[1200px] px-6 py-8 text-[13px] text-black/60",children:(0,r.t)(e,"general.loading")})]}):x?(0,l.jsxs)("main",{className:"min-h-screen bg-white",children:[(0,l.jsx)("div",{className:"border-b border-black/10",children:(0,l.jsxs)("div",{className:"mx-auto flex w-full max-w-[1200px] items-center justify-between px-6 py-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-black",children:(0,r.t)(e,"trustRules.title")}),(0,l.jsx)("p",{className:"text-[13px] text-black/60",children:(0,r.t)(e,"trustRules.subtitle")})]}),(0,l.jsx)(c.Z,{currentLocale:e,onLocaleChange:t})]})}),(0,l.jsx)("section",{className:"mx-auto w-full max-w-[1200px] px-6 py-8",children:(0,l.jsx)("div",{className:"rounded-xl border border-red-200 bg-red-50 p-4 text-[13px] text-red-800",children:(0,r.t)(e,"trustRules.error")})})]}):(0,l.jsxs)("main",{className:"min-h-screen bg-white",children:[(0,l.jsx)("div",{className:"border-b border-black/10",children:(0,l.jsxs)("div",{className:"mx-auto flex w-full max-w-[1200px] items-center justify-between px-6 py-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold text-black",children:(0,r.t)(e,"trustRules.title")}),(0,l.jsx)("p",{className:"text-[13px] text-black/60",children:(0,r.t)(e,"trustRules.subtitle")})]}),(0,l.jsx)(c.Z,{currentLocale:e,onLocaleChange:t})]})}),(0,l.jsxs)("section",{className:"mx-auto w-full max-w-[1200px] px-6 py-8",children:[0===s.length&&(0,l.jsx)("div",{className:"rounded-xl border border-black/10 bg-white p-6 text-center text-[14px] text-black/60",children:(0,r.t)(e,"trustRules.empty")}),s.length>0&&(0,l.jsx)("div",{className:"overflow-x-auto rounded-xl border border-black/10 bg-white",children:(0,l.jsxs)("div",{className:"min-w-[760px]",children:[(0,l.jsxs)("div",{className:"grid grid-cols-[1.2fr_1fr_120px_90px_160px_140px] gap-3 border-b border-black/10 bg-black/5 px-4 py-3 text-[12px] font-semibold uppercase tracking-wide text-black/60",children:[(0,l.jsx)("div",{children:(0,r.t)(e,"trustRules.tableRule")}),(0,l.jsx)("div",{children:(0,r.t)(e,"trustRules.tableCode")}),(0,l.jsx)("div",{children:(0,r.t)(e,"trustRules.tableDelta")}),(0,l.jsx)("div",{children:(0,r.t)(e,"trustRules.tableActive")}),(0,l.jsx)("div",{children:(0,r.t)(e,"trustRules.tableUpdated")}),(0,l.jsx)("div",{children:(0,r.t)(e,"trustRules.tableActions")})]}),s.map(t=>{let s=(0,r.t)(e,t.titleKey)||t.code,a=(0,r.t)(e,t.descriptionKey)||"",i=j(t);return(0,l.jsxs)("div",{className:"grid grid-cols-[1.2fr_1fr_120px_90px_160px_140px] gap-3 border-b border-black/5 px-4 py-3 text-[13px] text-black last:border-b-0",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-semibold text-black",children:s}),a&&(0,l.jsx)("div",{className:"text-[11px] text-black/50",children:a})]}),(0,l.jsx)("div",{className:"font-mono text-[12px] text-black/70",children:t.code}),(0,l.jsx)("div",{children:(0,l.jsx)("input",{type:"number",min:-100,max:100,value:t.delta,onChange:e=>g(t.code,e.target.valueAsNumber),className:"h-9 w-full rounded-lg border border-black/20 px-2 text-[12px] text-black focus:border-black focus:outline-none","aria-label":(0,r.t)(e,"trustRules.tableDelta")})}),(0,l.jsx)("div",{children:(0,l.jsxs)("label",{className:"flex items-center gap-2 text-[12px] text-black/70",children:[(0,l.jsx)("input",{type:"checkbox",checked:t.isActive,onChange:()=>k(t.code),className:"h-4 w-4 accent-black","aria-label":(0,r.t)(e,"trustRules.tableActive")}),t.isActive?(0,r.t)(e,"trustRules.active"):(0,r.t)(e,"trustRules.inactive")]})}),(0,l.jsx)("div",{className:"text-[12px] text-black/60",children:new Date(t.updatedAt).toLocaleString()}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("button",{type:"button",onClick:()=>y(t.code),disabled:t.saving||!i,className:"rounded-lg border border-black/20 px-3 py-1 text-[12px] font-semibold text-black hover:bg-black/5 disabled:cursor-not-allowed disabled:opacity-50",children:t.saving?(0,r.t)(e,"trustRules.saving"):(0,r.t)(e,"trustRules.save")}),(0,l.jsx)("button",{type:"button",onClick:()=>N(t.code),disabled:t.saving||!i,className:"rounded-lg border border-black/10 px-3 py-1 text-[12px] text-black/60 hover:bg-black/5 disabled:cursor-not-allowed disabled:opacity-40",children:(0,r.t)(e,"trustRules.reset")}),b===t.code&&w&&(0,l.jsx)("span",{className:"text-[11px] text-green-700",children:w}),i&&(0,l.jsx)("span",{className:"text-[11px] text-yellow-700",children:(0,r.t)(e,"trustRules.unsaved")})]})]},t.code)})]})})]})]})}},6540:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var l=s(7437),a=s(154);function r(e){let{currentLocale:t,onLocaleChange:s}=e;return(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,l.jsx)("span",{style:{fontSize:13,color:"#64748b",fontWeight:500},children:(0,a.t)(t,"general.panelLanguage")}),(0,l.jsx)("div",{style:{display:"flex",gap:4,background:"#f8fafc",padding:4,borderRadius:6,border:"1px solid #e5e7eb"},children:a.kU.map(e=>(0,l.jsx)("button",{onClick:()=>s(e),style:{padding:"6px 12px",border:"none",borderRadius:4,background:t===e?"linear-gradient(135deg, #2EC4B6, #0FA3B1)":"transparent",color:t===e?"#fff":"#64748b",cursor:"pointer",fontSize:13,fontWeight:t===e?600:500,transition:"all 0.2s ease"},children:e.toUpperCase()},e))})]})}}},function(e){e.O(0,[36,971,23,744],function(){return e(e.s=2854)}),_N_E=e.O()}]);