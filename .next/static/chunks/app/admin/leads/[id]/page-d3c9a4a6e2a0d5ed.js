(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[582],{184:function(e,r,t){Promise.resolve().then(t.bind(t,6432)),Promise.resolve().then(t.bind(t,538)),Promise.resolve().then(t.bind(t,6085))},6463:function(e,r,t){"use strict";var o=t(1169);t.o(o,"notFound")&&t.d(r,{notFound:function(){return o.notFound}}),t.o(o,"useParams")&&t.d(r,{useParams:function(){return o.useParams}}),t.o(o,"useRouter")&&t.d(r,{useRouter:function(){return o.useRouter}}),t.o(o,"useSearchParams")&&t.d(r,{useSearchParams:function(){return o.useSearchParams}})},8064:function(e,r,t){"use strict";Object.defineProperty(r,"$",{enumerable:!0,get:function(){return n}});let o=t(4590);function n(e){let{createServerReference:r}=t(6671);return r(e,o.callServer)}},6432:function(e,r,t){"use strict";t.d(r,{default:function(){return d}});var o=t(7437),n=t(2265),i=t(6463);function d(e){let{leadId:r,messages:t}=e,d=(0,i.useRouter)(),[l,a]=(0,n.useState)(""),[s,c]=(0,n.useState)(!1),[u,f]=(0,n.useState)(""),[b,m]=(0,n.useState)(!1),h=async e=>{if(e.preventDefault(),f(""),m(!1),!l.trim()){f("Mesaj boş olamaz");return}c(!0);try{let e=await fetch("/api/chat/".concat(r,"/messages"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({senderType:"CLINIC",body:l.trim()})});if(201===e.status)a(""),m(!0),d.refresh();else{var t;let r=await e.json();(null===(t=r.fieldErrors)||void 0===t?void 0:t.body)?f(r.fieldErrors.body[0]):f(r.error||"Bir hata oluştu")}}catch(e){f("Bağlantı hatası")}finally{c(!1)}};return(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{style:{border:"1px solid #e5e7eb",borderRadius:8,padding:12,marginBottom:16,minHeight:150,maxHeight:300,overflowY:"auto",backgroundColor:"#f9fafb"},children:0===t.length?(0,o.jsx)("p",{style:{color:"#9ca3af",textAlign:"center",marginTop:50,fontSize:14},children:"Hen\xfcz mesaj yok"}):(0,o.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:t.map(e=>(0,o.jsxs)("div",{style:{padding:10,borderRadius:6,backgroundColor:"PATIENT"===e.senderType?"#dbeafe":"CLINIC"===e.senderType?"#dcfce7":"#fef3c7",border:"1px solid #e5e7eb",fontSize:13},children:[(0,o.jsxs)("div",{style:{fontSize:11,color:"#6b7280",marginBottom:4},children:[(0,o.jsx)("strong",{children:"PATIENT"===e.senderType?"Hasta":"CLINIC"===e.senderType?"Klinik":"Admin"})," ","• ",new Date(e.createdAt).toLocaleString("tr-TR")]}),(0,o.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:e.body})]},e.id))})}),(0,o.jsxs)("form",{onSubmit:h,children:[u&&(0,o.jsx)("div",{style:{padding:10,backgroundColor:"#fee2e2",border:"1px solid #dc2626",borderRadius:4,marginBottom:12,color:"#991b1b",fontSize:13},children:u}),b&&(0,o.jsx)("div",{style:{padding:10,backgroundColor:"#d1fae5",border:"1px solid #10b981",borderRadius:4,marginBottom:12,color:"#065f46",fontSize:13},children:"✓ Mesaj g\xf6nderildi"}),(0,o.jsxs)("div",{style:{marginBottom:12},children:[(0,o.jsx)("label",{style:{display:"block",fontSize:13,color:"#6b7280",marginBottom:4},children:"Klinik adına mesaj g\xf6nder:"}),(0,o.jsx)("textarea",{value:l,onChange:e=>a(e.target.value),placeholder:"Mesajınızı yazın...",style:{width:"100%",padding:10,border:"1px solid #ccc",borderRadius:4,fontSize:14,minHeight:60,resize:"vertical"},maxLength:2e3})]}),(0,o.jsx)("button",{type:"submit",disabled:s,style:{padding:"8px 16px",backgroundColor:s?"#9ca3af":"#059669",color:"#fff",border:"none",borderRadius:4,fontSize:14,fontWeight:500,cursor:s?"not-allowed":"pointer"},children:s?"G\xf6nderiliyor…":"G\xf6nder"})]}),(0,o.jsx)("p",{style:{marginTop:12,fontSize:12,color:"#9ca3af"},children:"Not: PII (telefon, e-posta, URL vb.) i\xe7eren mesajlar engellenecektir."})]})}},538:function(e,r,t){"use strict";t.d(r,{default:function(){return d}});var o=t(7437),n=t(2265);t(4590);var i=(0,t(8064).$)("2c349d0abaadeefe3561a910c86897efe2941339");function d(e){let{leadId:r,clinics:t,treatments:d,currentClinicId:l,currentTreatmentId:a}=e,[s,c]=(0,n.useState)(l||""),[u,f]=(0,n.useState)(a||""),[b,m]=(0,n.useTransition)(),[h,p]=(0,n.useState)(null),g={width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:4,fontSize:14},y={display:"block",marginBottom:4,fontWeight:500};return(0,o.jsxs)("form",{onSubmit:e=>{e.preventDefault(),p(null);let t=new FormData;t.set("clinicId",s),t.set("treatmentId",u),m(async()=>{p(await i(r,t))})},children:[(null==h?void 0:h.success)&&(0,o.jsx)("div",{style:{padding:12,backgroundColor:"#d1fae5",border:"1px solid #10b981",borderRadius:4,marginBottom:16,color:"#065f46",fontSize:14},children:"✓ Eşleştirme kaydedildi"}),(null==h?void 0:h.error)&&!h.success&&(0,o.jsx)("div",{style:{padding:12,backgroundColor:"#fee2e2",border:"1px solid #dc2626",borderRadius:4,marginBottom:16,color:"#991b1b",fontSize:14},children:h.error}),(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:y,htmlFor:"clinicId",children:"Klinik"}),(0,o.jsxs)("select",{id:"clinicId",value:s,onChange:e=>c(e.target.value),style:g,children:[(0,o.jsx)("option",{value:"",children:"Se\xe7ilmedi"}),t.map(e=>(0,o.jsxs)("option",{value:e.id,children:[e.name," (",e.country,")"]},e.id))]})]}),(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:y,htmlFor:"treatmentId",children:"Tedavi"}),(0,o.jsxs)("select",{id:"treatmentId",value:u,onChange:e=>f(e.target.value),style:g,children:[(0,o.jsx)("option",{value:"",children:"Se\xe7ilmedi"}),d.map(e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,o.jsx)("button",{type:"submit",disabled:b,style:{padding:"10px 20px",backgroundColor:b?"#9ca3af":"#059669",color:"#fff",border:"none",borderRadius:4,fontSize:14,fontWeight:500,cursor:b?"not-allowed":"pointer"},children:b?"Kaydediliyor…":"Eşleştirmeyi Kaydet"})]})}},6085:function(e,r,t){"use strict";t.d(r,{default:function(){return a}});var o=t(7437),n=t(2265);t(4590);var i=(0,t(8064).$)("a9593ccac651ccc0edb62bdc89acc3ad58562c83"),d=t(5876);let l={NEW:"Yeni",IN_REVIEW:"İnceleniyor",OFFER_SENT:"Teklif G\xf6nderildi",CLOSED:"Kapatıldı"};function a(e){var r,t;let{leadId:a,currentStatus:s,currentNotes:c}=e,[u,f]=(0,n.useState)(s),[b,m]=(0,n.useState)(c),[h,p]=(0,n.useTransition)(),[g,y]=(0,n.useState)(null),x={width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:4,fontSize:14},v={display:"block",marginBottom:4,fontWeight:500};return(0,o.jsxs)("form",{onSubmit:e=>{e.preventDefault(),y(null);let r=new FormData;r.set("status",u),r.set("notes",b),p(async()=>{y(await i(a,r))})},children:[(null==g?void 0:g.success)&&(0,o.jsx)("div",{style:{padding:12,backgroundColor:"#d1fae5",border:"1px solid #10b981",borderRadius:4,marginBottom:16,color:"#065f46",fontSize:14},children:"✓ Kaydedildi"}),(null==g?void 0:g.error)&&!g.success&&(0,o.jsx)("div",{style:{padding:12,backgroundColor:"#fee2e2",border:"1px solid #dc2626",borderRadius:4,marginBottom:16,color:"#991b1b",fontSize:14},children:g.error}),(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:v,htmlFor:"status",children:"Durum"}),(0,o.jsx)("select",{id:"status",value:u,onChange:e=>f(e.target.value),style:x,children:d.PT.map(e=>(0,o.jsx)("option",{value:e,children:l[e]},e))}),(null==g?void 0:null===(r=g.fieldErrors)||void 0===r?void 0:r.status)&&(0,o.jsx)("div",{style:{color:"#dc2626",fontSize:13,marginTop:4},children:g.fieldErrors.status[0]})]}),(0,o.jsxs)("div",{style:{marginBottom:16},children:[(0,o.jsx)("label",{style:v,htmlFor:"notes",children:"Notlar"}),(0,o.jsx)("textarea",{id:"notes",value:b,onChange:e=>m(e.target.value),style:{...x,minHeight:80,resize:"vertical"},placeholder:"İsteğe bağlı notlar..."}),(null==g?void 0:null===(t=g.fieldErrors)||void 0===t?void 0:t.notes)&&(0,o.jsx)("div",{style:{color:"#dc2626",fontSize:13,marginTop:4},children:g.fieldErrors.notes[0]})]}),(0,o.jsx)("button",{type:"submit",disabled:h,style:{padding:"10px 20px",backgroundColor:h?"#9ca3af":"#2563eb",color:"#fff",border:"none",borderRadius:4,fontSize:14,fontWeight:500,cursor:h?"not-allowed":"pointer"},children:h?"Kaydediliyor…":"Kaydet"})]})}},5876:function(e,r,t){"use strict";t.d(r,{PT:function(){return o}});let o=["NEW","IN_REVIEW","OFFER_SENT","CLOSED"]}},function(e){e.O(0,[971,23,744],function(){return e(e.s=184)}),_N_E=e.O()}]);