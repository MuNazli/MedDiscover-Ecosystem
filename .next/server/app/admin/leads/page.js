(()=>{var e={};e.id=3965,e.ids=[3965],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3576:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>d.a,__next_app__:()=>p,originalPathname:()=>x,pages:()=>c,routeModule:()=>b,tree:()=>o}),a(727),a(6042),a(5866);var s=a(3191),l=a(8716),r=a(7922),d=a.n(r),i=a(5231),n={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>i[e]);a.d(t,n);let o=["",{children:["admin",{children:["leads",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,727)),"C:\\Users\\MustafaNazliHamiTour\\Desktop\\MedDiscover\\03-platform\\M01-lead-intake\\src\\app\\admin\\leads\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,6042)),"C:\\Users\\MustafaNazliHamiTour\\Desktop\\MedDiscover\\03-platform\\M01-lead-intake\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\MustafaNazliHamiTour\\Desktop\\MedDiscover\\03-platform\\M01-lead-intake\\src\\app\\admin\\leads\\page.tsx"],x="/admin/leads/page",p={require:a,loadChunk:()=>Promise.resolve()},b=new s.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/admin/leads/page",pathname:"/admin/leads",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},8156:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,2994,23)),Promise.resolve().then(a.t.bind(a,6114,23)),Promise.resolve().then(a.t.bind(a,9727,23)),Promise.resolve().then(a.t.bind(a,9671,23)),Promise.resolve().then(a.t.bind(a,1868,23)),Promise.resolve().then(a.t.bind(a,4759,23))},8949:(e,t,a)=>{Promise.resolve().then(a.bind(a,9270))},7110:()=>{},9270:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var s=a(326),l=a(7577),r=a(1030);function d({open:e,lead:t,onClose:a,onUpdateStatus:d,onAddNote:i,onDeleteNote:n,updatingStatus:o,updateError:c}){let[x,p]=(0,l.useState)(""),[b,m]=(0,l.useState)(null);return e&&t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",onClick:a,children:(0,s.jsxs)("div",{className:"relative w-full max-w-[720px] rounded-xl border border-black/10 bg-white p-6 shadow-xl",onClick:e=>e.stopPropagation(),children:[s.jsx("button",{type:"button",onClick:a,className:"absolute right-4 top-4 rounded-md border border-black/10 bg-white px-2 py-1 text-[12px] font-semibold text-black hover:bg-black/5",children:"Close"}),(0,s.jsxs)("div",{className:"space-y-1",children:[s.jsx("h2",{className:"text-xl font-semibold text-black",children:"Lead Details"}),(0,s.jsxs)("p",{className:"text-[13px] text-black/60",children:["Submitted ",new Date(t.createdAt).toLocaleString()]})]}),(0,s.jsxs)("div",{className:"mt-6 grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-lg border border-black/10 p-4",children:[s.jsx("div",{className:"text-[12px] uppercase tracking-wide text-black/50",children:"Contact"}),(0,s.jsxs)("div",{className:"mt-2 space-y-2 text-[14px] text-black",children:[s.jsx("div",{className:"font-semibold",children:t.fullName}),s.jsx("div",{children:t.email}),s.jsx("div",{children:t.phone||"No phone provided"})]})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-black/10 p-4",children:[s.jsx("div",{className:"text-[12px] uppercase tracking-wide text-black/50",children:"Package"}),(0,s.jsxs)("div",{className:"mt-2 space-y-2 text-[14px] text-black",children:[s.jsx("div",{className:"font-semibold",children:t.packageTitle}),s.jsx("div",{children:t.destination}),s.jsx("div",{children:t.treatmentCategory})]})]})]}),(0,s.jsxs)("div",{className:"mt-4 rounded-lg border border-black/10 p-4 text-[14px] text-black",children:[s.jsx("div",{className:"text-[12px] uppercase tracking-wide text-black/50",children:"Message"}),s.jsx("div",{className:"mt-2 whitespace-pre-line text-[14px] text-black/80",children:t.message||"No message provided."})]}),(0,s.jsxs)("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-lg border border-black/10 p-4 text-[14px] text-black",children:[s.jsx("div",{className:"text-[12px] uppercase tracking-wide text-black/50",children:"Locale"}),s.jsx("div",{className:"mt-2",children:t.locale})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-black/10 p-4 text-[14px] text-black",children:[s.jsx("div",{className:"text-[12px] uppercase tracking-wide text-black/50",children:"Status"}),s.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:r.PT.map(e=>s.jsx("button",{type:"button",onClick:()=>d(t.id,e),disabled:o||t.status===e,className:`rounded-lg border px-3 py-1 text-[12px] font-semibold ${t.status===e?"border-black bg-black text-white":"border-black/20 text-black hover:bg-black/5"} ${o?"opacity-50":""}`,children:e},e))}),c&&s.jsx("div",{className:"mt-2 text-[12px] text-red-600",children:c})]})]}),(0,s.jsxs)("div",{className:"mt-4 rounded-lg border border-black/10 p-4",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[s.jsx("div",{className:"text-[12px] uppercase tracking-wide text-black/50",children:"Notes / Internal Comments"}),s.jsx("div",{className:"text-[12px] text-black/60",children:"Internal only. L\xfctfen telefon/e-posta gibi PII yazmayın."})]}),(0,s.jsxs)("div",{className:"mt-3 space-y-2",children:[s.jsx("textarea",{value:x,onChange:e=>{p(e.target.value),b&&m(null)},maxLength:1e3,rows:3,placeholder:"Add an internal note...",className:"w-full rounded-lg border border-black/20 p-3 text-[13px] text-black focus:border-black focus:outline-none"}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-[12px] text-black/50",children:[(0,s.jsxs)("span",{children:[x.trim().length,"/",1e3]}),s.jsx("button",{type:"button",onClick:()=>{let e=x.trim();if(!e){m("Note cannot be empty.");return}if(e.length>1e3){m("Note is too long.");return}i(t.id,e),p("")},className:"rounded-lg border border-black/20 px-3 py-1 text-[12px] font-semibold text-black hover:bg-black/5",children:"Add note"})]}),b&&s.jsx("div",{className:"text-[12px] text-red-600",children:b})]}),(0,s.jsxs)("div",{className:"mt-4 space-y-3",children:[0===t.notes.length&&s.jsx("div",{className:"rounded-lg border border-black/10 bg-black/5 p-3 text-[12px] text-black/60",children:"No notes yet."}),t.notes.map(e=>(0,s.jsxs)("div",{className:"rounded-lg border border-black/10 p-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-[12px] text-black/50",children:[s.jsx("span",{children:new Date(e.createdAt).toLocaleString()}),s.jsx("button",{type:"button",onClick:()=>n(t.id,e.id),className:"text-[12px] font-semibold text-black hover:text-black/70",children:"Delete"})]}),s.jsx("p",{className:"mt-2 whitespace-pre-line text-[13px] text-black/80",children:e.text})]},e.id))]})]})]})}):null}function i(){let[e,t]=(0,l.useState)([]),[a,i]=(0,l.useState)(!0),[n,o]=(0,l.useState)(!1),[c,x]=(0,l.useState)(""),[p,b]=(0,l.useState)("ALL"),[m,u]=(0,l.useState)(null),[h,g]=(0,l.useState)(!1),[k,f]=(0,l.useState)(!1),[v,j]=(0,l.useState)(null),N=async()=>{i(!0),o(!1);try{let e=await fetch("/api/leads",{method:"GET"});if(!e.ok)throw Error("Failed to load");let a=await e.json();t(Array.isArray(a.leads)?a.leads:[])}catch{o(!0)}finally{i(!1)}},y=(0,l.useMemo)(()=>{let t=c.trim().toLowerCase();return e.filter(e=>("ALL"===p||e.status===p)&&(!t||e.fullName.toLowerCase().includes(t)||e.email.toLowerCase().includes(t))).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime())},[e,c,p]),w=e=>{u(e),j(null),g(!0)},S=async(a,s)=>{let l=e.find(e=>e.id===a);if(l&&l.status!==s){f(!0),j(null);try{if(!(await fetch("/api/leads",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a,status:s})})).ok)throw Error("Update failed");t(e=>e.map(e=>e.id===a?{...e,status:s}:e)),u(e=>e&&e.id===a?{...e,status:s}:e)}catch{j("Update failed")}finally{f(!1)}}},A=async(e,a)=>{f(!0),j(null);try{let s=await fetch("/api/leads",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,noteText:a})});if(!s.ok)throw Error("Update failed");let l=await s.json();l?.lead&&(t(t=>t.map(t=>t.id===e?l.lead:t)),u(t=>t&&t.id===e?l.lead:t))}catch{j("Update failed")}finally{f(!1)}},P=async(e,a)=>{f(!0),j(null);try{let s=await fetch("/api/leads",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,deleteNoteId:a})});if(!s.ok)throw Error("Update failed");let l=await s.json();l?.lead&&(t(t=>t.map(t=>t.id===e?l.lead:t)),u(t=>t&&t.id===e?l.lead:t))}catch{j("Update failed")}finally{f(!1)}};return(0,s.jsxs)("main",{className:"min-h-screen bg-white",children:[s.jsx("div",{className:"border-b border-black/10",children:(0,s.jsxs)("div",{className:"mx-auto flex w-full max-w-[1200px] flex-col gap-3 px-6 py-6 md:flex-row md:items-center md:justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("h1",{className:"text-2xl font-semibold text-black",children:"Leads Inbox"}),s.jsx("p",{className:"text-[13px] text-black/60",children:"Manage inbound lead requests"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[s.jsx("input",{type:"text",value:c,onChange:e=>x(e.target.value),placeholder:"Search name or email",className:"h-10 w-[220px] rounded-lg border border-black/20 px-3 text-[13px] text-black focus:border-black focus:outline-none"}),(0,s.jsxs)("select",{value:p,onChange:e=>b(e.target.value),className:"h-10 rounded-lg border border-black/20 px-3 text-[13px] text-black focus:border-black focus:outline-none",children:[s.jsx("option",{value:"ALL",children:"All statuses"}),r.PT.map(e=>s.jsx("option",{value:e,children:e},e))]}),s.jsx("button",{type:"button",onClick:()=>{x(""),b("ALL")},className:"h-10 rounded-lg border border-black/20 px-3 text-[13px] font-semibold text-black hover:bg-black/5",children:"Reset"})]})]})}),(0,s.jsxs)("section",{className:"mx-auto w-full max-w-[1200px] px-6 py-8",children:[a&&s.jsx("div",{className:"space-y-3",children:Array.from({length:6}).map((e,t)=>s.jsx("div",{className:"h-12 rounded-lg border border-black/10 bg-black/5 animate-pulse"},t))}),!a&&n&&(0,s.jsxs)("div",{className:"rounded-xl border border-black/10 bg-white p-6 text-center",children:[s.jsx("div",{className:"text-[14px] font-semibold text-black",children:"Failed to load leads"}),s.jsx("button",{type:"button",onClick:N,className:"mt-4 rounded-lg border border-black/20 px-4 py-2 text-[13px] font-semibold text-black hover:bg-black/5",children:"Retry"})]}),!a&&!n&&0===y.length&&s.jsx("div",{className:"rounded-xl border border-black/10 bg-white p-6 text-center text-[14px] text-black/70",children:"No leads yet"}),!a&&!n&&y.length>0&&(0,s.jsxs)("div",{className:"overflow-hidden rounded-xl border border-black/10 bg-white",children:[(0,s.jsxs)("div",{className:"grid grid-cols-[140px_1.2fr_1.2fr_1.5fr_120px_120px] gap-3 border-b border-black/10 bg-black/5 px-4 py-3 text-[12px] font-semibold uppercase tracking-wide text-black/60",children:[s.jsx("div",{children:"Date"}),s.jsx("div",{children:"Name"}),s.jsx("div",{children:"Email"}),s.jsx("div",{children:"Package"}),s.jsx("div",{children:"Status"}),s.jsx("div",{children:"Actions"})]}),y.map(e=>(0,s.jsxs)("div",{className:"grid cursor-pointer grid-cols-[140px_1.2fr_1.2fr_1.5fr_120px_120px] gap-3 border-b border-black/5 px-4 py-3 text-[13px] text-black last:border-b-0 hover:bg-black/5",onClick:()=>w(e),children:[s.jsx("div",{className:"text-[12px] text-black/60",children:new Date(e.createdAt).toLocaleDateString()}),s.jsx("div",{className:"font-semibold",children:e.fullName}),s.jsx("div",{children:e.email}),s.jsx("div",{className:"truncate",children:e.packageTitle}),s.jsx("div",{className:"text-[12px] font-semibold",children:e.status}),s.jsx("div",{children:s.jsx("button",{type:"button",className:"rounded-lg border border-black/20 px-3 py-1 text-[12px] font-semibold text-black hover:bg-black/5",onClick:t=>{t.stopPropagation(),w(e)},children:"View"})})]},e.id))]})]}),s.jsx(d,{open:h,lead:m,onClose:()=>{g(!1),u(null),j(null)},onUpdateStatus:S,onAddNote:A,onDeleteNote:P,updatingStatus:k,updateError:v})]})}},1030:(e,t,a)=>{"use strict";a.d(t,{PT:()=>s});let s=["NEW","IN_REVIEW","OFFER_SENT","CLOSED"]},727:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>d,__esModule:()=>r,default:()=>i});var s=a(8570);let l=(0,s.createProxy)(String.raw`C:\Users\MustafaNazliHamiTour\Desktop\MedDiscover\03-platform\M01-lead-intake\src\app\admin\leads\page.tsx`),{__esModule:r,$$typeof:d}=l;l.default;let i=(0,s.createProxy)(String.raw`C:\Users\MustafaNazliHamiTour\Desktop\MedDiscover\03-platform\M01-lead-intake\src\app\admin\leads\page.tsx#default`)},6042:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i,metadata:()=>d});var s=a(9510);a(5023);let l=["DATABASE_URL","ADMIN_PASSPHRASE"],r={DATABASE_URL:"PostgreSQL connection string (e.g., postgresql://user:pass@host:5432/db)",ADMIN_PASSPHRASE:"Secret passphrase for CMS admin authentication"};!function(){let e=[],t=[];for(let a of l){let s=process.env[a];s&&""!==s.trim()||(e.push(a),t.push(`  ❌ ${a}: ${r[a]}`))}if(e.length>0)throw Error(["","\uD83D\uDEA8 MISSING REQUIRED ENVIRONMENT VARIABLES","","The following environment variables are required but not set:","",...t,"","Please set these in your .env.local (development) or deployment platform (production).",""].join("\n"))}();let d={title:"MedDiscover – Quality Healthcare, Available Worldwide",description:"We help you access trusted clinics and guide you through your treatment journey."};function i({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{children:e})})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[8948,4471],()=>a(3576));module.exports=s})();