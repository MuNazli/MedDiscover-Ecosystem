"use strict";(()=>{var e={};e.id=6522,e.ids=[6522],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5987:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>h,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>f,staticGenerationAsyncStorage:()=>c});var s={};r.r(s),r.d(s,{DELETE:()=>l,POST:()=>d});var n=r(9303),a=r(8716),o=r(670),i=r(7070),u=r(9834);async function d(e){let t=(0,u.h)(e,u.f.ADMIN_AUTH);if(t)return t;try{let{key:t}=await e.json(),r=process.env.ADMIN_PASSPHRASE;if(!r)return i.NextResponse.json({error:"Admin key not configured"},{status:500});if(t!==r)return i.NextResponse.json({error:"Invalid admin key"},{status:401});let s=i.NextResponse.json({ok:!0});return s.cookies.set("md_admin","1",{httpOnly:!0,secure:!0,sameSite:"lax",path:"/",maxAge:604800}),s}catch{return i.NextResponse.json({error:"Invalid request"},{status:400})}}async function l(){let e=i.NextResponse.json({ok:!0});return e.cookies.delete("md_admin"),e}let p=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/cms/auth/route",pathname:"/api/cms/auth",filename:"route",bundlePath:"app/api/cms/auth/route"},resolvedPagePath:"C:\\Users\\MustafaNazliHamiTour\\Desktop\\MedDiscover\\03-platform\\M01-lead-intake\\src\\app\\api\\cms\\auth\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:c,serverHooks:f}=p,x="/api/cms/auth/route";function h(){return(0,o.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:c})}},9834:(e,t,r)=>{r.d(t,{f:()=>i,h:()=>o});var s=r(7070);let n=new Map;setInterval(()=>{let e=Date.now();for(let[t,r]of Array.from(n.entries()))r.resetAt<e&&n.delete(t)},3e5);let a={maxRequests:10,windowMs:6e4};function o(e,t=a){let r=function(e){let t=e.headers.get("x-forwarded-for"),r=e.headers.get("x-real-ip");return t?t.split(",")[0].trim():r||"unknown"}(e),o=`${r}`,i=Date.now(),u=n.get(o);if(!u||u.resetAt<i)return u={count:1,resetAt:i+t.windowMs},n.set(o,u),null;if(u.count+=1,u.count>t.maxRequests){let e=Math.ceil((u.resetAt-i)/1e3);return s.NextResponse.json({error:"Too many requests. Please try again later.",retryAfter:`${e} seconds`},{status:429,headers:{"Retry-After":e.toString(),"X-RateLimit-Limit":t.maxRequests.toString(),"X-RateLimit-Remaining":"0","X-RateLimit-Reset":u.resetAt.toString()}})}return null}let i={LEAD_SUBMISSION:{maxRequests:10,windowMs:6e4},ADMIN_AUTH:{maxRequests:5,windowMs:6e4}}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,5972],()=>r(5987));module.exports=s})();