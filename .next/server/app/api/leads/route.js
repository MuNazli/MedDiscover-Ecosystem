"use strict";(()=>{var e={};e.id=5350,e.ids=[5350],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},701:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>R,requestAsyncStorage:()=>N,routeModule:()=>g,serverHooks:()=>S,staticGenerationAsyncStorage:()=>x});var n={};r.r(n),r.d(n,{GET:()=>l,PATCH:()=>f,POST:()=>c});var s=r(9303),o=r(8716),a=r(670),i=r(7070),u=r(4659);let p=[],d=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;async function l(){return i.NextResponse.json({leads:p},{status:200})}async function c(e){try{let{packageId:t,packageTitle:r,destination:n,treatmentCategory:s,fullName:o,email:a,phone:u,message:l,consentPrivacy:c,consentContact:f,locale:g}=await e.json()??{};if(!t||!r||!o||!a||!n||!s||!g)return i.NextResponse.json({error:"Missing required fields"},{status:400});if(!d.test(String(a)))return i.NextResponse.json({error:"Invalid email"},{status:400});if(!0!==c||!0!==f)return i.NextResponse.json({error:"Both consents are required"},{status:400});let N={id:"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():String(Date.now()),createdAt:new Date().toISOString(),fullName:String(o),email:String(a),phone:u?String(u):null,message:l?String(l):null,packageId:String(t),packageTitle:String(r),destination:String(n),treatmentCategory:String(s),locale:String(g),status:"NEW",notes:[]};return p.unshift(N),i.NextResponse.json({ok:!0,id:N.id},{status:200})}catch{return i.NextResponse.json({error:"Internal server error"},{status:500})}}async function f(e){try{let{id:t,status:r,noteText:n,deleteNoteId:s}=await e.json()??{};if(!t)return i.NextResponse.json({error:"Invalid request"},{status:400});let o=p.find(e=>e.id===t);if(!o)return i.NextResponse.json({error:"Not found"},{status:404});if(r){if(!(0,u.bQ)(r))return i.NextResponse.json({error:"Invalid status"},{status:400});o.status=r}if("string"==typeof n){let e=n.trim();if(!e)return i.NextResponse.json({error:"Note cannot be empty"},{status:400});if(e.length>1e3)return i.NextResponse.json({error:"Note too long"},{status:400});o.notes.unshift({id:"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():String(Date.now()),text:e,createdAt:new Date().toISOString()})}if(s){let e=o.notes.findIndex(e=>e.id===s);if(-1===e)return i.NextResponse.json({error:"Note not found"},{status:404});o.notes.splice(e,1)}return i.NextResponse.json({ok:!0,lead:o},{status:200})}catch{return i.NextResponse.json({error:"Internal server error"},{status:500})}}let g=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/leads/route",pathname:"/api/leads",filename:"route",bundlePath:"app/api/leads/route"},resolvedPagePath:"C:\\Users\\MustafaNazliHamiTour\\Desktop\\MedDiscover\\03-platform\\M01-lead-intake\\src\\app\\api\\leads\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:N,staticGenerationAsyncStorage:x,serverHooks:S}=g,m="/api/leads/route";function R(){return(0,a.patchFetch)({serverHooks:S,staticGenerationAsyncStorage:x})}},4659:(e,t,r)=>{r.d(t,{PT:()=>n,Sb:()=>o,bQ:()=>s});let n=["NEW","IN_REVIEW","OFFER_SENT","CLOSED"];function s(e){return"NEW"===e||"IN_REVIEW"===e||"OFFER_SENT"===e||"CLOSED"===e}function o(e){return s(e)?e:"IN_REVIEW"}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[8948,5972],()=>r(701));module.exports=n})();